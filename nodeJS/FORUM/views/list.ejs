<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="/css/main.css">
</head>

<!--
    ejsÎ•º Ïù¥Ïö©Ìïú ÏÑúÎ≤ÑÏÇ¨Ïù¥Îìú Î†åÎçîÎßÅ
    1. ejs Ïì∞Î©¥ html ÏïàÏóêÏÑú ÏÑúÎ≤ÑÎç∞Ïù¥ÌÑ∞ ÏÇ¨Ïö© Í∞ÄÎä•
    2. ejs ÌååÏùºÏùÄ views Ìè¥ÎçîÏïàÏóê ÎßåÎì†Îã§.
    3. res.renderÎ°ú Ïú†Ï†ÄÏóêÍ≤å ÌéòÏù¥ÏßÄÎ•º Î≥¥ÎÇ¥Ï§ÄÎã§.
-->

<body class="grey-bg">
  <!-- include (Ïû¨ÏÇ¨Ïö© Ïö©Ïù¥) -->
  <%- include('nav.ejs') %>

    <div class="white-bg">

      <% for(let i=0; i<value.length; i++){ %>
        <div class="list-box">
          <h4>
            <a href="/detail/<%= value[i]._id %>"><%= value[i].title %></a>
            <a href="/edit/<%= value[i]._id %>">‚úèÔ∏è</a>
            <span class="delete" data-id="<%= value[i]._id %>">üóëÔ∏è</span>
          </h4>
          <p><%= value[i].content %></p>
        </div>
      <% } %>

    </div> 
    <script>

      const deleteBtn = document.querySelectorAll('.delete');
      for(let i=0; i<deleteBtn.length; i++){
        deleteBtn[i].addEventListener('click', async (e) => {
          const targetId = e.target.dataset.id;
          const response = await fetch(`/delete?id=${targetId}`, {
            method: 'DELETE'
          })
          const data = await response.json();
          console.log(JSON.stringify(data));
        });
      }

    </script>
  </body>
</html>